<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>EagleCraft Mini</title>
<style>
  body { margin: 0; overflow: hidden; }
  canvas { display: block; }
  #info {
    position: absolute;
    top: 10px;
    left: 10px;
    color: white;
    font-family: Arial, sans-serif;
    background: rgba(0,0,0,0.5);
    padding: 5px 10px;
    border-radius: 5px;
  }
</style>
</head>
<body>
<div id="info">WASD bewegen | Linksklick: Block entfernen | Rechtsklick: Block platzieren</div>
<script src="https://cdn.jsdelivr.net/npm/three@0.158.0/build/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.158.0/examples/js/controls/PointerLockControls.js"></script>
<script>
  let scene, camera, renderer, controls;
  let objects = [];
  const worldSize = 10;

  init();
  animate();

  function init() {
    // Szene
    scene = new THREE.Scene();
    scene.background = new THREE.Color(0x87ceeb);

    // Kamera
    camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);

    // Renderer
    renderer = new THREE.WebGLRenderer();
    renderer.setSize(window.innerWidth, window.innerHeight);
    document.body.appendChild(renderer.domElement);

    // Licht
    const light = new THREE.DirectionalLight(0xffffff, 1);
    light.position.set(1, 1, 1).normalize();
    scene.add(light);

    // Boden aus Blöcken
    const blockSize = 1;
    const geometry = new THREE.BoxGeometry(blockSize, blockSize, blockSize);
    const material = new THREE.MeshLambertMaterial({color: 0x228B22});
    for (let x = -worldSize; x <= worldSize; x++) {
      for (let z = -worldSize; z <= worldSize; z++) {
        const cube = new THREE.Mesh(geometry, material);
        cube.position.set(x, 0, z);
        scene.add(cube);
        objects.push(cube);
      }
    }

    // PointerLockControls für Maus
    controls = new THREE.PointerLockControls(camera, renderer.domElement);
    document.body.addEventListener('click', () => controls.lock());
    scene.add(controls.getObject());

    // Position der Kamera
    camera.position.y = 2;

    // Tastatur-Input
    const move = {forward: false, backward: false, left: false, right: false};
    document.addEventListener('keydown', e => {
      if (e.code === 'KeyW') move.forward = true;
      if (e.code === 'KeyS') move.backward = true;
      if (e.code === 'KeyA') move.left = true;
      if (e.code === 'KeyD') move.right = true;
    });
    document.addEventListener('keyup', e => {
      if (e.code === 'KeyW') move.forward = false;
      if (e.code === 'KeyS') move.backward = false;
      if (e.code === 'KeyA') move.left = false;
      if (e.code === 'KeyD') move.right = false;
    });

    // Maus Klicks für Blöcke
    document.addEventListener('mousedown', e => {
      const raycaster = new THREE.Raycaster();
      const mouse = new THREE.Vector2();
      mouse.x = 0;
      mouse.y = 0;
      raycaster.setFromCamera(mouse, camera);
      const intersects = raycaster.intersectObjects(objects);
      if (intersects.length > 0) {
        if (e.button === 0) { // linksklick
          scene.remove(intersects[0].object);
          objects = objects.filter(o => o !== intersects[0].object);
        } else if (e.button === 2) { // rechtsklick
          const cubeGeo = new THREE.BoxGeometry(1,1,1);
          const cubeMat = new THREE.MeshLambertMaterial({color: 0x8B4513});
          const cube = new THREE.Mesh(cubeGeo, cubeMat);
          cube.position.copy(intersects[0].point).add(intersects[0].face.normal);
          cube.position.x = Math.round(cube.position.x);
          cube.position.y = Math.round(cube.position.y);
          cube.position.z = Math.round(cube.position.z);
          scene.add(cube);
          objects.push(cube);
        }
      }
    });
  }

  function animate() {
    requestAnimationFrame(animate);

    // Bewegung
    const speed = 0.1;
    const dir = new THREE.Vector3();
    if (move.forward) dir.z -= speed;
    if (move.backward) dir.z += speed;
    if (move.left) dir.x -= speed;
    if (move.right) dir.x += speed;
    controls.moveRight(dir.x);
    controls.moveForward(dir.z);

    renderer.render(scene, camera);
  }

  // Rechtsklick-Menü deaktivieren
  document.addEventListener('contextmenu', e => e.preventDefault());
</script>
</body>
</html>